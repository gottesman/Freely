/* App Shell Layout */
.app {
    border-radius: var(--app-border-radius);
    overflow:hidden;
    display:flex;
    flex-direction:column;

    /* background: rgba(var(--bg), var(--bg-opacity)); */
    height:calc(100vh - (var(--app-shadow-size) * 2));
    margin: var(--app-shadow-size);
    box-shadow: inset 0 0 1px 1px var(--app-border-color), var(--app-shadow-color) 0 2px var(--app-shadow-size) 0;
}
.app::before { content:""; position:absolute; inset:0; background: var(--color-bg-solid); z-index:-1; }

.maximized {
    --app-shadow-size: 0px;
    box-shadow: none;
    border: none;
    border-radius: 0;
}
.maximized .tb-btn{
    border: none;
}

.window-body { overflow:hidden; width:100%; height:100%; display:flex; flex-direction:column; gap:var(--footer-gap); }
.content { padding:0 var(--padding-sm); display:flex; width:100%; height:100%; min-width:0; min-height:0; overflow:hidden; box-sizing:border-box; }
.content .left-panel, .content .right-panel { flex:0 0 auto; }
.center-area { flex:1 1 auto; min-width:0; display:flex; flex-direction:column; gap:12px; position:relative; border-radius:var(--app-border-radius); overflow:hidden; clip-path: inset(0 round var(--app-border-radius)); isolation:isolate; contain:paint; }
.center-area .center-tabs { flex:1 1 auto; min-width:0; width:100%; }

/* Panels */
.left-panel, .right-panel { border-radius: var(--app-border-radius); width:220px; box-sizing:border-box; display:flex; flex-direction:column; min-height:0; overflow:hidden; }
.rt-header{ margin: 8px 0;}
.rt-header,.shelf-title,.shelf-cards{padding: 0 var(--padding-md);}
.main-panels { background: var(--panels-bg); transition: width 0.2s ease; }
.bottom-player { height: var(--footer-height); background: var(--surface-2); border-top: 1px solid var(--border-strong); }

/* Disable transition while actively resizing (handle :active or global .is-resizing flag) */
.is-resizing .main-panels,
.resize-handle:active + .main-panels,
.main-panels + .resize-handle:active,
.resize-handle:active ~ .main-panels { transition: none !important; }
.main-panels.collapsed { width:54px; overflow-x: hidden; }
.main-panels .panel-collapse-toggle { cursor:pointer; font-size:12px; padding:4px; }

/* Resize Handle */
.resize-handle { width:10px; flex:0 0 10px; cursor:col-resize; position:relative; display:flex; align-items:center; justify-content:center; user-select:none; background:transparent; z-index:30; touch-action:none; min-width:6px !important; }
.resize-handle::before { content:""; width:1px; height:100%; border-radius:2px; background: linear-gradient(#fff0,#fffa 20%, #fffa 80%, #fff0); opacity:0; transition:opacity .2s; }
.resize-handle:hover::before, .resize-handle:focus::before, .resize-handle:active::before { opacity:.85; }
.resize-handle.disabled { cursor:default; }
.resize-handle.disabled::before { opacity:0; }
.resize-handle::after { content:""; position:absolute; left:-4px; right:-4px; top:0; bottom:0; }

/* Splash */
.app-loading { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; background:transparent; z-index:10000; }
.app-loading img { filter: drop-shadow(0 8px 28px rgba(0 0 0 / .55)); }
.app-loading .splash-box { position:relative; width:400px; height:300px; display:flex; align-items:center; justify-content:center; }
.app-loading .splash-box img { width:100%; height:100%; object-fit:contain; pointer-events:none; user-select:none; }
.app-loading .splash-status { position:absolute; bottom:10px; left:0; right:0; text-align:center; font-size:12px; letter-spacing:.5px; font-family: system-ui, sans-serif; color:#cfe4ff; text-shadow:0 2px 4px rgba(0 0 0 / .6); opacity:.9; animation:splash-status-pulse 2.4s ease-in-out infinite; }
@keyframes splash-status-pulse { 0%,100% { opacity:.9 } 50% { opacity:.55 } }

.overflow-ellipsis { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

/* Range Inputs (sliders) themed with design tokens */
input[type="range"] {
    -webkit-appearance: none;
    appearance: none;
    width: 100%;
    background: transparent;
    cursor: pointer;

    /* Consumers can set --range-progress: 0%..100% inline to color the filled part on WebKit */
}

/* WebKit/Chromium track */
input[type="range"]::-webkit-slider-runnable-track {
    height: 6px;
    border-radius: 999px;
    background:
        linear-gradient(var(--accent), var(--accent)) 0 0/var(--range-progress, 0%) 100% no-repeat,
        color-mix(in srgb, var(--text) 10%, transparent);
}

/* WebKit/Chromium thumb */
input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--accent);
    margin-top: calc((6px - 16px) / 2);
    transition: transform var(--dur-med) var(--ease-standard), filter var(--dur-med) var(--ease-standard);
}
input[type="range"]:hover::-webkit-slider-thumb { filter: brightness(1.1); }
input[type="range"]:active::-webkit-slider-thumb { transform: scale(0.92); }

/* Firefox track */
input[type="range"]::-moz-range-track {
    height: 6px;
    border-radius: 999px;
    background: color-mix(in srgb, var(--text) 10%, transparent);
}

/* Firefox progress (filled part) */
input[type="range"]::-moz-range-progress {
    height: 6px;
    border-radius: 999px 0 0 999px;
    background: var(--accent);
}

/* Firefox thumb */
input[type="range"]::-moz-range-thumb {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--accent);
    transition: transform var(--dur-med) var(--ease-standard), filter var(--dur-med) var(--ease-standard);
}
input[type="range"]:hover::-moz-range-thumb { filter: brightness(1.1); }
input[type="range"]:active::-moz-range-thumb { transform: scale(0.92); }

/* Focus styles */
input[type="range"]:focus-visible { outline: none; }
input[type="range"]:focus-visible::-webkit-slider-runnable-track,
input[type="range"]:focus-visible::-moz-range-track {
    box-shadow: 0 0 0 1px var(--accent);
    border-color: var(--accent);
}

/* Checkbox Input (custom styled) */
input[type="checkbox"] {
    -webkit-appearance: none;
    appearance: none;
    width: 18px;
    height: 18px;
    background: var(--surface-3);
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-sm);
    cursor: pointer;
    position: relative;
    transition: background var(--dur-med), border-color var(--dur-med), box-shadow var(--dur-med);
    flex-shrink: 0;
}

input[type="checkbox"]:hover {
    background: var(--surface-hover);
    border-color: var(--border-soft);
}

input[type="checkbox"]:focus-visible {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 1px var(--accent);
}

input[type="checkbox"]::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 10px;
    height: 10px;
    background: var(--accent);
    border-radius: 2px;
    opacity: 0;
    transform: translate(-50%, -50%) scale(0.8);
    transition: opacity var(--dur-med), transform var(--dur-med);
}

input[type="checkbox"]:checked::before {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
}

input[type="checkbox"]:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

input[type="checkbox"]:disabled:hover {
    background: var(--surface-3);
    border-color: var(--border-subtle);
}

/* Select Elements */

/*
select {
    background: var(--surface-3);
    border: 1px solid var(--border-subtle);
    color: var(--text);
    font: inherit;
    font-size: 14px;
    border-radius: var(--radius-sm);
    padding: 8px 32px 8px 12px;
    outline: none;
    cursor: pointer;
    transition: border-color var(--dur-med), background var(--dur-med), box-shadow var(--dur-med);
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right 8px center;
    background-size: 16px;
}

select:hover {
    background: var(--surface-hover);
    border-color: var(--border-soft);
}

select:focus-visible {
    border-color: var(--accent);
    background: var(--surface-3);
    box-shadow: 0 0 0 1px var(--accent);
}
*/

select option {
    background: var(--color-bg-solid);
    color: var(--text);
    padding: 8px 12px;
    font-size: 14px;
    cursor: pointer;
}

select option:hover,
select option:focus {
    background: var(--accent);
}

select option:checked {
    background: var(--text);
    color: var(--color-bg-solid);
}

/*
select:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

select:disabled:hover {
    background: var(--surface-3);
    border-color: var(--border-subtle);
}
*/
.dot.active {
    outline: solid 2px;
}